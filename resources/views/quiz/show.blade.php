@extends('layouts.app')
@section('content')
    <div class="row">        
        <div class="col-sm-12">


            <div id="root">
                <section id="LvWUz77cYWKmjcbB" style="z-index:0;overflow:hidden;display:grid;margin-top:-1px;position:relative;align-items:center;">
                <div id="CIqC1k5ykhSK8F40" style="background-color:#ffbde7;transform:scale(1, 1);overflow:hidden;width:100%;opacity:1.0;height:100%;top:0%;left:0%;position:absolute;">
                    <div id="UUPKdPINvYu9spEY" style="background-repeat:no-repeat;background-size:cover;top:-38.93229167%;left:0%;width:100%;background-image:url(images/f8a4dbcf8d996f54871b9cf7d31b60a9.png);background-position:center;position:relative;opacity:0.99;height:177.86458333%;">
                    </div>
                </div>
                <div id="oeOllgF5lCtNeJ50">
                    <div id="QH2Hiz0V9KeLORQA">
                    <div id="n0oGw46GaGS6aNts" style="padding-top:100%;transform:rotate(0deg);">
                        <div id="F4nOKCKrqgXZZz11" style="top:0px;left:0px;width:100%;position:absolute;height:100%;">
                        <div id="aiVUf1WINPITUZ4V" style="width:100%;opacity:1.0;height:100%;">
                            <div id="fnGJwbqpSIu8KJ91" style="transform:scale(1, 1);overflow:hidden;width:100%;height:100%;">
                            <div id="xR16N5X3wWB5GD4g" style="transform:rotate(0deg);top:0%;left:0%;width:100%;position:relative;opacity:1.0;height:100%;animation:anim-pulse 1.5s ease-in-out infinite;" class="qn_no">
                                {{-- <img src="images/1ffa0cf6de9f96a019b434fe809d9dc4.svg" alt="Number 1 Icon" loading="lazy" style="width:100%;height:100%;"> --}}

                            </div>
                            </div>
                        </div>
                        </div>
                    </div>
                    </div>
                    <div id="uwASc8t99RnSCmHg">
                    <div id="Uh2fhbAXy8kQpXS7" style="padding-top:56.25%;transform:rotate(0deg);">
                        <div id="kLJDsc7yPuFxvNwZ" style="top:0px;left:0px;width:100%;position:absolute;height:100%;">
                        <div id="seb2LO7dcoBfD6Vz" style="width:100%;opacity:1.0;height:100%;">
                            <div id="tCmH1L948UEpeOSy" style="transform:scale(1, 1);overflow:hidden;width:100%;height:100%;">
                            <div id="JttD7DS5cFsU4tp9" style="transform:rotate(0deg);top:0%;left:0%;width:100%;position:relative;opacity:1.0;height:100%;">
                                        <span class="timer"></span>
                            </div>
                            </div>
                        </div>
                        </div>
                    </div>
                    </div>
                    <div id="dbt9akWlH18MyV7X">
                    <div id="mfAgYvHNcaXETWJf" style="padding-top:18.31478433%;transform:rotate(0deg);">
                        <div id="mHoRXgsI8ryfrQp1" style="top:0px;left:0px;width:100%;position:absolute;height:100%;">
                        <svg id="NSgXswapCQMfbSqA" viewBox="0 0 265.3403 48.5965" preserveAspectRatio="none" style="overflow:hidden;top:0%;left:0%;width:100%;position:absolute;opacity:1.0;height:100%;">
                            <g id="DnfSdfVovpPtDWXi" style="transform:scale(1, 1);">
                            <path id="wu3vU0youPS4e6Hy" d="M10.00000063,0.0 L255.34027036,0.0 C257.99243543,0.0 260.53597472,1.05356847 262.41133862,2.92893237 264.28670253,4.80429627 265.34027100000003,7.34783556 265.34027100000003,10.00000063 L265.34027100000003,38.59649976 C265.34027100000003,41.24866483 264.28670253,43.79220412 262.41133862,45.66756803 260.53597472,47.54293193 257.99243543,48.596500400000004 255.34027036,48.596500400000004 L10.00000063,48.596500400000004 C7.34783557,48.596500400000004 4.80429628,47.54293193 2.92893237,45.667568020000004 1.05356847,43.79220412 0.0,41.24866483 0.0,38.59649976 L0.0,10.00000063 C0.0,7.34783557 1.05356847,4.80429628 2.92893237,2.92893237 4.80429627,1.05356847 7.34783556,0.0 10.00000063,0.0 Z" style="fill:#38729d;opacity:1.0;">
                            </path>
                            </g>
                        </svg>
                        </div>
                    </div>
                    </div>
                    <div id="YhFVxq8eFgL19BfG">
                    <div id="fYbTSqgCWaFQ246I" style="padding-top:16.82646466%;transform:rotate(0deg);">
                        <div id="pxoGrUG7sCbMgZYi" style="top:0px;left:0px;width:100%;position:absolute;height:100%;">
                        <div id="OjgOCoIhT3QalzKr" style="flex-direction:column;display:flex;width:100%;justify-content:flex-start;opacity:1.0;height:100%;">
                            <p id="svONAnRTCJBT555q" style="color:#ffffff;font-family:YAFLd8sKbwc-1;line-height:1.4em;text-align:center;"><span id="ECErebG9DxQKog1F" style="color:#ffffff;" class="question">Who devised the periodic table </span></p>
                        </div>
                        </div>
                    </div>
                    </div>
                    <div id="ouUjVyWQyrzmfeV9">
                    <div id="BEEYUj6pAJdD096Y" style="padding-top:31.27806871%;transform:rotate(0deg);">
                        <div id="MPmK0vm6JcFfMoKV" style="top:0px;left:0px;width:100%;position:absolute;height:100%;">
                        <svg id="nzXMHcF4eaVHpch6" viewBox="0 0 102.3081 32.0" preserveAspectRatio="none" style="overflow:hidden;top:0%;left:0%;width:100%;position:absolute;opacity:1.0;height:100%;">
                            <g id="JYHq8Q4VktBdr6kp" style="transform:scale(1, 1);">
                            <path id="FELGsdBWELhiz732" d="M86.30810697890075,0.0 L16.0,0.0 L0.0,16.0 L16.0,32.0 L86.30810697890075,32.0 L102.30810697890075,16.0 L86.30810697890075,0.0" style="fill:#38729d;opacity:1.0;">
                            </path>
                            </g>
                        </svg>
                        </div>
                    </div>
                    </div>
                    <div id="I1NruuWqWhJHcNkH" class="options">
                    <div id="iM6JJl8BZCplrdd7" style="padding-top:13.72187617%;transform:rotate(0deg);">
                        <div id="bKNtI5P3zWv31pVH" style="top:0px;left:0px;width:100%;position:absolute;height:100%;">
                        <div id="SlEsZvGrVTWzZnlt" style="flex-direction:column;display:flex;width:100%;justify-content:flex-start;opacity:1.0;height:100%;">
                            <p id="I2Nr5NTEIpVZkKkv" style="text-transform:none;color:#ffffff;letter-spacing:0em;font-family:YAFLd8sKbwc-1;line-height:1.4em;text-align:center;"><span id="SE6imfEmdvSRBNhi" style="color:#ffffff;" class="option_a option">Dmitri Mendeleev</span><br></p>
                        </div>
                        </div>
                    </div>
                    </div>
                    <div id="qFbOCqCW442Oq5jq">
                    <div id="lxbWz4rkHsGoYAYU" style="padding-top:31.27806871%;transform:rotate(0deg);">
                        <div id="aYVIqG5G8zvFSqoI" style="top:0px;left:0px;width:100%;position:absolute;height:100%;">
                        <svg id="wum9WmnTatisSeN6" viewBox="0 0 102.3081 32.0" preserveAspectRatio="none" style="overflow:hidden;top:0%;left:0%;width:100%;position:absolute;opacity:1.0;height:100%;">
                            <g id="fQjtcFu7xzJZhOuI" style="transform:scale(1, 1);">
                            <path id="rl2myTwiZCAsUuwK" d="M86.30810697890075,0.0 L16.0,0.0 L0.0,16.0 L16.0,32.0 L86.30810697890075,32.0 L102.30810697890075,16.0 L86.30810697890075,0.0" style="fill:#38729d;opacity:1.0;">
                            </path>
                            </g>
                        </svg>
                        </div>
                    </div>
                    </div>
                    <div id="bnYKbrEnouCT9dNt" class="options">
                    <div id="jbpE9p1UF2ue5hdj" style="padding-top:14.99303196%;transform:rotate(0deg);">
                        <div id="eOY88uXMnPfkGukE" style="top:0px;left:0px;width:100%;position:absolute;height:100%;">
                        <div id="iFnKAcOUe54PD4yU" style="flex-direction:column;display:flex;width:100%;justify-content:flex-start;opacity:1.0;height:100%;">
                            <p id="QiaSlrvT6SFSF6hi" style="text-transform:none;color:#ffffff;letter-spacing:0em;font-family:YAFLd8sKbwc-1;line-height:1.4em;text-align:center;"><span id="vzvvm5Dzk728zObS" style="color:#ffffff;" class="option_b option">Michael Faraday</span><br></p>
                        </div>
                        </div>
                    </div>
                    </div>
                    <div id="pNduzNIuhbv3MxTw">
                    <div id="ZxcROTFNFM5Nk9hr" style="padding-top:31.27806871%;transform:rotate(0deg);">
                        <div id="HFnB1QbeMSRAGQSZ" style="top:0px;left:0px;width:100%;position:absolute;height:100%;">
                        <svg id="YVMYPCDtesgsCfru" viewBox="0 0 102.3081 32.0" preserveAspectRatio="none" style="overflow:hidden;top:0%;left:0%;width:100%;position:absolute;opacity:1.0;height:100%;">
                            <g id="WS5Q8MW866zOU2z6" style="transform:scale(1, 1);">
                            <path id="au1wUm977fFTyTWZ" d="M86.30810697890075,0.0 L16.0,0.0 L0.0,16.0 L16.0,32.0 L86.30810697890075,32.0 L102.30810697890075,16.0 L86.30810697890075,0.0" style="fill:#38729d;opacity:1.0;">
                            </path>
                            </g>
                        </svg>
                        </div>
                    </div>
                    </div>
                    <div id="mMDOMCTipLXImerq" class="options">
                    <div id="PgumqIv5Pst1HzvT" style="padding-top:11.79483627%;transform:rotate(0deg);">
                        <div id="IzQoffzW70evJwLl" style="top:0px;left:0px;width:100%;position:absolute;height:100%;">
                        <div id="qAAyTHjfWTq1yrLu" style="flex-direction:column;display:flex;width:100%;justify-content:flex-start;opacity:1.0;height:100%;">
                            <p id="taGOcZCgr66hOT3V" style="text-transform:none;color:#ffffff;letter-spacing:0em;font-family:YAFLd8sKbwc-1;line-height:1.4em;text-align:center;"><span id="F4P2NScQrkK7DbVv" style="color:#ffffff;" class="option_c option">James Clerk Maxwell</span><br></p>
                        </div>
                        </div>
                    </div>
                    </div>
                    <div id="uvlVseV8NeZBlRda">
                    <div id="C8XrNC15W43PvN2c" style="padding-top:31.27806871%;transform:rotate(0deg);">
                        <div id="Y4302n7SoFPq9gBY" style="top:0px;left:0px;width:100%;position:absolute;height:100%;">
                        <svg id="HSfiQWuzC0Ac3KFh" viewBox="0 0 102.3081 32.0" preserveAspectRatio="none" style="overflow:hidden;top:0%;left:0%;width:100%;position:absolute;opacity:1.0;height:100%;">
                            <g id="vs4EtPHQ2c6YbWOp" style="transform:scale(1, 1);">
                            <path id="ZOwkRFe5nJGjOXWz" d="M86.30810697890075,0.0 L16.0,0.0 L0.0,16.0 L16.0,32.0 L86.30810697890075,32.0 L102.30810697890075,16.0 L86.30810697890075,0.0" style="fill:#38729d;opacity:1.0;">
                            </path>
                            </g>
                        </svg>
                        </div>
                    </div>
                    </div>
                    <div id="WzYlPC2G45LQVJO5" class="options">
                    <div id="Qq89IU43paOnObja" style="padding-top:21.35379275%;transform:rotate(0deg);">
                        <div id="qn1dBCspNeQ1Ddst" style="top:0px;left:0px;width:100%;position:absolute;height:100%;">
                        <div id="vVdgGxw0V0Y9B8Ce" style="flex-direction:column;display:flex;width:100%;justify-content:flex-start;opacity:1.0;height:100%;">
                            <p id="NBPMYxwkz487299G" style="text-transform:none;color:#ffffff;letter-spacing:0em;font-family:YAFLd8sKbwc-1;line-height:1.4em;text-align:center;"><span id="bs1SIFgbsBvIIDTa" style="color:#ffffff;" class="option_d option">Marie Curie</span><br></p>
                        </div>
                        </div>
                    </div>
                    </div>

                   
                    <div id="Ifh5pINvc0pI35v7">
                    <div id="pDa3uWwgD3uJIWik" style="padding-top:22.54274511%;transform:rotate(0deg);">
                        <div id="W4D87uv1kFN4j1hE" style="top:0px;left:0px;width:100%;position:absolute;height:100%;">
                        <svg id="KZD0N1HCMAcbn3n0" viewBox="0 0 141.9525 32.0" preserveAspectRatio="none" style="overflow:hidden;top:0%;left:0%;width:100%;position:absolute;opacity:1.0;height:100%;">
                            <g id="fc8YbvJlFaqrqk9r" style="transform:scale(1, 1);">
                            <path id="wQXvyggUBM35pkH2" d="M125.95254327101898,0.0 C134.789098751976,0.0 141.95254327101898,7.1634440422058105 141.95254327101898,16.0 C141.95254327101898,24.83655548095703 134.789098751976,32.0 125.95254327101898,32.0 L16.0,32.0 C7.1634440422058105,32.0 0.0,24.83655548095703 0.0,16.0 C0.0,7.1634440422058105 7.1634440422058105,0.0 16.0,0.0 L125.95254327101898,0.0" style="fill:#38729d;opacity:1.0;">
                            </path>
                            </g>
                        </svg>
                        </div>
                    </div>
                    </div>
                    <div id="X6LwAjFhJkPRAfy3">
                    <div id="ZGUS7B48vSBOZIGC" style="padding-top:42.72127411%;transform:rotate(0deg);">
                        <div id="WaBmZVzggQd87NZy" style="top:0px;left:0px;width:100%;position:absolute;height:100%;">
                        <a href="{{ route('dashboard') }}">
                        <div id="bnYMTARmpN4YeD7Y" style="flex-direction:column;display:flex;width:100%;justify-content:flex-start;opacity:1.0;height:100%;">
                            <p id="ruc5qXR8YOoQYbeH" style="text-transform:none;color:#ffffff;letter-spacing:0em;font-family:YAFLd8sKbwc-1;line-height:1.4em;text-align:center;"><span id="EE8lxK0seHGMr7bH" style="color:#ffffff;">Reset</span><br></p>
                        </div>
                        </a>
                        </div>
                    </div>
                    </div>


                </div>
                <input type="hidden" id="question_id">
                <input type="hidden" id="quiz_id">
                <input type="hidden" id="qn_no">
                </section>
            </div>
           
        </div>       
    </div>



    <script>
        $(document).ready(function(){
            // alert();

            function place_values(quiz_id,question_id,qn_no, question, option_a, option_b, option_c, option_d,option_a_id,option_b_id,option_c_id,option_d_id)
            {
                // alert(qn_no);
                // alert(question);
                // alert(option_a);
                // alert(option_b);
                // alert(option_c);    
                // alert(option_d);              
                $(".qn_no").text(qn_no);
                $(".question").html(question);
                $(".option_a").html(option_a);
                $(".option_b").html(option_b);
                $(".option_c").html(option_c);
                $(".option_d").html(option_d);

                // $(".question").data('id', question_id);
                // $(".option_a").data('id', option_a_id);
                // $(".option_b").data('id', option_b_id);
                // $(".option_c").data('id', option_c_id);
                // $(".option_d").data('id', option_d_id);

                $(".question").attr('data-id', question_id);
                $(".option_a").attr('data-id', option_a_id);
                $(".option_b").attr('data-id', option_b_id);
                $(".option_c").attr('data-id', option_c_id);
                $(".option_d").attr('data-id', option_d_id);

                $("#question_id").val(question_id);
                $("#quiz_id").val(quiz_id);
                $("#qn_no").val(qn_no);

            }
            var user_id = "{{ Auth::user()->id }}";
            var qn_no = "{{ $qn_no }}";
            var question = "{{ $qn->question }}";
            var quiz_id = "{{ $quiz_uuid }}";
            var question_id = "{{ $qn->question_id }}";
            var option_a = "{{ $qn_options[0]->option }}";
            var option_a_id = "{{ $qn_options[0]->id }}";
            var option_b = "{{ $qn_options[1]->option }}";
            var option_b_id = "{{ $qn_options[1]->id }}";
            var option_c = "{{ $qn_options[2]->option }}";
            var option_c_id = "{{ $qn_options[2]->id }}";
            var option_d = "{{ $qn_options[3]->option }}";
            var option_d_id = "{{ $qn_options[3]->id }}";

            place_values(quiz_id,question_id,qn_no, question, option_a, option_b, option_c, option_d,option_a_id,option_b_id,option_c_id,option_d_id);
            run_timer();


            $('.options').click(function(){

                var question_id = $("#question_id").val();
                var quiz_id = $("#quiz_id").val();
                var qn_no = $("#qn_no").val();
                var answer_id = $(this).children().find('.option').data('id');                
                submit_answer(user_id, quiz_id, question_id, qn_no, answer_id);
            });

            function run_timer()
            {
                timeLeft = 3;
                question_id = $("#question_id").val();
                quiz_id = $("#quiz_id").val();
                qn_no = $("#qn_no").val();
                user_id = "{{ Auth::user()->id }}";
                answer_id = 0; 
                
                

                $(".timer").html(timeLeft);
                let countdown = setInterval(function() {
                    timeLeft -= 1;
                    $(".timer").html(timeLeft);
                    if (timeLeft <= 0) {
                        clearInterval(countdown);
                        submit_answer(user_id, quiz_id, question_id, qn_no, answer_id);
                    } 
                }, 1000); 
            }

            



            // class="options"



            //  class="qn_no",
            //  class="question"
            //  class="option_a"
            //  class="option_b"
            //  class="option_c"
            //  class="option_d"

            // 'quiz_uuid' => $quiz_uuid,
            //     'quiz_name' => $quiz->name,
            //     'qn_no' => 1,
            //     'qn_total' => $quiz->total_question,
            //     'qn' => $quiz->questions()->first(),
            //     'qn_options' => $quiz->questions()->first()->options


            function submit_answer(userId, quizId, questionId, questionNo, answerId)
            {
                if(userId > 0)
                {
                    $.ajax({
                        type: "POST",
                        url: "{{ route('quiz.answer') }}",
                        headers: {
                            'X-CSRF-TOKEN': "{{ csrf_token() }}"
                        },
                        data: {
                            userId: userId,
                            quizId: quizId,
                            questionId: questionId,
                            questionNo: questionNo,
                            answerId: answerId

                        },
                        success: function (data) {
                            console.log(data);
                            if(data.is_end == true)
                            {
                                window.location.href = "{{ route('quiz.result', ':quiz_uuid') }}".replace(':quiz_uuid', data.quiz_uuid);
                                
                            }

                            qn_no = data.qn_no;                            
                            question = data.qn.question;                            
                            quiz_id = data.quiz_uuid;                            
                            question_id = data.qn.question_id;                            
                            option_a = data.qn_options[0].option;
                            option_a_id = data.qn_options[0].id;
                            option_b = data.qn_options[1].option;
                            option_b_id = data.qn_options[1].id;
                            option_c = data.qn_options[2].option;
                            option_c_id = data.qn_options[2].id;
                            option_d = data.qn_options[3].option;
                            option_d_id = data.qn_options[3].id;

                            place_values(quiz_id,question_id,qn_no, question, option_a, option_b, option_c, option_d,option_a_id,option_b_id,option_c_id,option_d_id);
                            run_timer();

                        },
                        error: function (data) {
                            console.log(data);
                        }
                    });
                    
                }

                

            }
        });
    </script>
    
@endsection